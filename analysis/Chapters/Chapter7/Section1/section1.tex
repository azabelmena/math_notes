%----------------------------------------------------------------------------------------
%	SECTION 1.1
%----------------------------------------------------------------------------------------

\section{The Riemann-Stieltjes Integral.}

\begin{definition}
    Let $[a,b]$ be an interval. A \textbf{partition} of $[a,b]$ is a set of
    points  $P=\{x_0,x_1, \dots, x_n\}$ such that $a=x_0<x_1< \dots <x_n=b$, and
    we write $\Delta{x_i}=x_i-x_{i-1}$. Now let  $f:[a,b] \rightarrow \R$ be a bounded 
    realvalued function, and for each partition $P$ of  $[a,b]$ let
    $M_i=\sup{f}$ and  $m_i=\inf_{f}$ for all  $x_{i-1} \leq x \leq x_i$. We
    define the \textbf{upper Riemann sum} and the \textbf{lower Riemmann sum} to
    of  $f$ with respect to be:
       \begin{align}
           U(f,P) &= \sum_{i=1}^{n}{M_i\Delta{x_i}} \\
           L(f,P) &= \sum_{i=1}^{n}{m_i\Delta{x_i}}
       \end{align}   
    respectively. We also define the \textbf{upper Riemann integral} and the
    \textbf{lower Riemann integral} of $f$ over  $[a,b]$ to be: 
       \begin{align}
           \bar{\int_{a}^{b}}{f(x)}dx=\inf{U(f,P)} \\
           \bbar{\int_{a}^{b}}{f(x)}dx=\sup{L(f,P)}
       \end{align}
    Respectively.
    
    If $\bar{\int_{a}^{b}}{f}=\bbar{\int_{a}^{b}}{f}$, then we say that  $f$ is
    \textbf{Riemann integrable} on  $[a,b]$, and we its value the
    \textbf{Riemann integral}, and denote it to be: 
        \begin{equation}
            \int_{a}^{b}{f(x)}dx=\bar{\int_{a}^{b}}{f(x)}dx=\bbar{\int_{a}^{b}}{f(x)}dx
        \end{equation} 
\end{definition}

\begin{lemma}\label{7.1.1}
    $\bar{\int_{a}^{b}}{f}$,and  $\bbar{\int_{a}^{b}}{f}$ are defined for every
    bounded realvalued function $f$ over  $[a,b]$.
\end{lemma}
\begin{proof}
    Let $f$ be bounded on  $[a,b]$, then there are  $m$ and  $M$ such that  $m
    \leq f \leq M$ for all  $a \leq x \leq b$. Now let  $P$ be a partition of
    $[a,b]$. Since  $\inf{f} \leq \sup{f}$, we have that $m \leq m_i=\inf{f}
    \leq M_i=\sup{f} \leq M$, thus  $m(b-a) \leq L(f,P) \leq U(f,P) \leq
    M(b-a)$, hence $L$ and  $U$ form a bounded set, and we are done.
\end{proof}
\begin{corollary}
    $L(f,P) \leq U(f,P )$ for every bounded function $f$.
\end{corollary}

Now the question of the integrability of $f$ is a very delicate matter, and
requires a closer scrutiny on the concepts of upper and lower sums. Infact, it
turns out that the Riemann integral is a consequence of a more general class of
integrals. Developng this more general situation will allow us to discern facts
about the Riemann integral.

\begin{definition}
    Let $\alpha$ be a bounded monontonically increasing function on  $[a,b]$,
    and let  $P$ be a partition of  $[a,b]$ and let
    $\Delta{\alpha_i}=\alpha(x_i)-\alpha(x_{i-1})$. For any realvalued, bounded
    function on  $[a,b]$, defined the \textbf{upper sum} and the \textbf{lower
    sum} of $f$ with respect to  $P$ and  $\alpha$ to be: 
        \begin{align}
            U(f,P,\alpha) &= \sum_{i=1}^{n}{M_i\Delta{\alpha_i}} \\		
            L(f,P,\alpha) &= \sum_{i=1}^{n}{m_i\Delta{\alpha_i}}
        \end{align}
        Where $M_i=\sup{f}$ and  $m_i=\inf{f}$ for all  $x_{i-1} \leq x \leq
        x_i$, and again, define the \textbf{upper integral} and  \textbf{lower
        integral} of $f$ with respect to  $\alpha$ on  $[a,b]$ to be:
            \begin{align}
                \bar{\int_{a}^{b}}{f(x)}d\alpha=\inf{U(f,P,\alpha)} \\
                \bbar{\int_{a}^{b}}{f(x)}d\alpha=\sup{L(f,P,\alpha)}	
            \end{align}
            If $\bar{\int_{a}^{b}}{f}d\alpha=\bbar{\int_{a}^{b}}{f}d\alpha$, we
            call the value:
                \begin{equation}
                    \int_{a}^{b}{f(x)}d\alpha=\bar{\int_{a}^{b}}{f(x)}d\alpha=\bbar{\int_{a}^{b}}{f(x)}d\alpha
                \end{equation}
            the \textbf{Riemann-Stieltjes integral} of $f$ with respect to  $f$
            on  $[a,b]$. If such an integra exists, we say that  $f$ is
            \textbf{integrable} with respect to  $\alpha$ on  $[a,b]$.
\end{definition}

\begin{example}
    Let $\alpha(x)=\alpha$, be defined over  $[a,b]$. Then  $\alpha$ is
    monontonically increasing, and our definititions reduces to those for the
    Riemann integral. Here  $U(f,P,x)=U(f,P)$ and  $L(f,P,x)=L(F,P)$.
\end{example} 

We are now in a position to investigate the properties of integrability, in the
Riemann-Stieltjes sense.

\begin{definition}
    Let $a,b]$ be an interval, and let  $P$ and  $Q$ be partitions of  $[a,b]$.
    We say that  $Q$ is a \textbf{refinment} of $P$ if  $P \susbeteq Q$, and we
    also say that $Q$ is \textbf{finer} than  $P$. Now if neither  $P$ nor  $Q$
    is a refinment of the other, we say that the two partitions are
    \textbf{noncomparable}.
\end{definition}

\begin{lemma}\label{7.1.2}
    Let $P$ and  $Q$ be partitions of and interval $[a,b]$, then  $P \cup Q$ is
    a partition of  $[a,b]$, and is a refinment of both  $P$ and  $Q$.
\end{lemma}
\begin{proof}
    If $P$ is a refinment of  $Q$, or viceversa, then we are done; so suppose
    that  $P$ and  $Q$ are noncomparable. Let  $P=\{x_0,x_1, \dots, x_n\}$ and
    $Q=\{y_0,y_1, \dots, y_m\}$ with $a=x_0<x_1< \dots x_n=b$ and $a=y_0<y_1<
    \dots y_m=b$. Then $P \cup Q=\{x_0,y_0,x_1,y_1, \dots, x_n,y_m\}$ and
    $a=x_0=y_0 < x_1,y_1 < \dots <x_n=y_m=b$, thus $P \cup Q$ is a partition of
    $[a,b]$, that it is a refinment of  $P$ and  $Q$ follows trivially.
\end{proof}

\begin{theorem}\label{7.1.3}
    Let $\alpha$ be monontonically increasing, and bounded on  $[a,b]$, and let
    $P$ and  $Q$ be partitions of  $[a,b]$. If  $Q$ is a refinment of  $P$, then
    $L(f,P,\alpha) \leq L(f,Q,\alpha)$ and  $U(f,Q,\alpha) \leq U(f,P,\alpha)$.
\end{theorem}
\begin{proof}
    Let $Q=P \cup \{x'\}$ and suppose that  $x_{i-1} \leq x' \leq x_i$.  Let 
    $w_1=\inf{f}$ for $x_{i-1} \leq x \leq x'$ and let $w_2=\inf{f}$ for $x'
    \leq x \leq x_i$. Then $m_i \leq w_1,w_2$, thus
    $L(f,Q,\alpha)-L(f,P,\alpha)=(w_1-m_i)(\alpha(b)-\alpha(a))-(w_2-m_i)(\alpha(b)-\alpha(a))
    \geq 0$, we are done. The proof is analogous for $U$.
\end{proof}
\begin{corollary}
    $L(f,P,\alpha)$ is monontonically increasing and  $U(f,P,\alpha)$ is
    monontonically decreasing.		
\end{corollary}
\begin{proof}
    We note that if $Q$ is a refinment of  $P$, then  $|P| \leq |Q|$, the result
    follows by direct application.
\end{proof}
\begin{remark}
    If $Q$ contains  $k$ more points than  $P$, we can repeat the proof
    inductively.
\end{remark}

\begin{theorem}\label{7.1.4}
    $\bbar{\int}{f}d\alpha \leq \bar{\int}{f}d\alpha$.
\end{theorem}
\begin{proof}
    Let $P=P_1 \cup P_2$ for partitions $P_1$ and $P_2$ of $[a,b]$. By theorem
    \ref{7.1.3} and lemma  \ref{7.1.1}, we have:
        \begin{equation}
            L(f,P_1,\alpha) \leq L(f,P_2,\alpha) \leq U(f,P_2, \alpha) \leq
            U(f,P_1, \alpha)
        \end{equation}
        Fixing $P_2$ and taking the supremum over all $P_1$, we get
        $\bbar{\int}{f} \leq U(f,P_2,\alpha)$, the infimum over $P_2$ we
        get $\bbar{\int}{f} \leq \bar{\int}{f}$
\end{proof}

\begin{theorem}\label{7.1.5}
    A realvalued function $f$ is integrable over an interval  $[a,b]$ if and
    only if for $\epsilon>0$, there is a partition $P$ such that:
        \begin{equation}
            U(f,P,\alpha)-L(f,P,\alpha)<\epsilon		
        \end{equation} 
\end{theorem}
\begin{proof}
    For every $P$, we have that  $L(f,P,\alpha) \leq \bbar{\int}{f} \leq
    \bar{\int}{f} \leq U(f,P,\alpha)$, so if  for $\epsilon>0$, we assume that
    $U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$, then we get that:
        \begin{equation}
            0 \leq
            \bar{\int_{a}^{b}}{f}d\alpha-\bbar{\int_{a}^{b}}{f}d\alpha<\epsilon		
        \end{equation} 
    implying integrablity for small enough $\epsilon$.
    
    Conversely, suppose that $\bar{\int}{f}=\bbar{\int}{f}$. Let  $\epsilon>0$.
    Then there are partitions  $P_1$ and $P_2$ such that
    $U(f,P_2,\alpha)-{\int}{f}<\frac{\epsilon}{2}$ and
    ${\int}{f}-L(f,P_1,\apha)<\frac{\epsilon}{2}$. Take $P=P_1 \cup P_2$, then
    by theorem \ref{7.1.4}, adding the inequalities we get
    $U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$.
\end{proof}

\begin{theorem}\label{7.1.6}
    The following hold:
        \begin{enumerate}[label=(\arabic*)]
            \item If $U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$ for some
                $\epsilon>0$ and some $P$, then it holds, with the same
                $\epsilon$, for every refinment of  $P$.

            \item If $U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$ for $P=\{x_0, \dots,
                x_n\}$, and if $s_i,t_i \in [x_{i-1},x_i]$, then:
                   \begin{equation}
                       \sum_{i=1}^{n}{|f(s_i)-f(t_i)|\Delta\alpha_i}<\epsilon
                   \end{equation}  

               \item If $f$ is integrable with respect to  $\alpha$ on  $[a,b]$,
                   and  $(2)$ holds, then: 
                   \begin{equation}
                       |\sum_{i=1}^{n}{f(t_i)\Delta{\alpha_i}}-\int_{a}^{b}{f}d\alpha|<\epsilon		
                   \end{equation} 
        \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{enumerate}[label=(\arabic*)]
        \item Theorem \ref{7.1.3} implies this.

        \item If $U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$, we have that
            $f(s_i),f(t_i) \in [m_i,M_i]$, hence $|f(s_i)-f(t_i)| \leq M_i=m_i$,
            thus we get that  $\sum{|f(s_i)-f(t_i)|\Delta{\alpha_i}} \leq U(f,P,\alpha)-L(f,P,\alpha)<\epsilon$

        \item We have $L(f,P,\alpha) \leq \sum{f(t_i)\Delta{\alpha_i}} \leq
    U(f,P,\alpha)$, and  $L(f,P,\alpha) \leq \int{f}d\alpha_i \leq
            U(f,P,\alpha)$, taking differences, we get the following.
    \end{enumerate}		
\end{proof}

\begin{theorem}\label{7.1.7}
    If $f$ is continuous on  $[a,b]$, then  $f$ is integrable with respect to
    $\alpha$ on  $[a,b]$.
\end{theorem}
\begin{proof}
    Let $\epsilon>0$, and choose  $\xi>0$ such that
    $(\alpha(b)-\alpha(a))\xi<\epsilon$. Now we have that  $f$ is uniformly
    continuous on  $[a,b]$, so there is a  $\delta>0$ such that
    $|f(x)-f(t)|<\xi$ whenever $|x-t|<\delta$ for $x,t \in [a,b]$. Now since $P$
    is a partition of  $[a,b]$, with  $\Delta{x_i}<\delta$ for all  $i$, then we
    have $M_i-m_i \leq \xi$ for  $i-1, \dots, n$ thus
    $U(f,P,\alpha)-L(f,P,\alpha)=\sum{(M_i-m_i)\Delta{\alpha_i}} \leq
    \xi(\alpha(b)-\alpha(a))<\epsilon$, therefore,  $f$ is integrable.
\end{proof}

\begin{theorem}\label{7.1.8}
    If $f$ is monotonic on  $[a,b]$, and  $\alpha$ is monotonic and continuous
    on  $[a,b]$, then  $f$ is integrable with respect to  $\alpha$ on  $[a,b]$.
\end{theorem}
\begin{proof}
    Let $\epsilon>0$, and for  $n>0$, construct a partition  $P$ such that
    $\Delta{\alpha_i}=\frac{\alpha(b)-\alpha(a)}{n}$ for $1 \leq i \leq n$,
    which is guaranteed by the intermediate value theorem.

    Now suppose without loss of generality that $f$ is monoton increasing, then
    $M_f(x_i)$ and  $m_i=f(x_{i-1})$  by the extreme value theorem, Then:
            \begin{equation*}
            U(f,P,\alpha)-L(f,P,\alpha)=\frac{\alpha(b)-\alpha(a)}{n}\sum{f(x_i)-f(x_{i-1})}=
                \frac{\alpha(b)-\alpha(a)}{n}(f(b)-f(a))<\epsilon
        \end{equation*}
    Taking $n$ large enough
    implies integrability.
\end{proof}

\begin{theorem}\label{7.1.9}
    Suppose that $f$ is bounded on  $[a,b]$, with only finitely many
    discontinuities on  $[a,b]$. Suppose that  $\alpha$ is continuous at every
    discontinuity of  $f$, then  $f$ is integrable with respect to  $\apha$ on
    $[a,b]$.
\end{theorem}
\begin{proof}
    Let $\epsilon>0$ and  $M=\sup{|f|}$ and let  $E$ be the set of all
    discontinuities of  $f$. Since  $E$ is finite, and  $\alpha$ is continuous
    on  $E$, then  $E$ can be covered by finitely many disjoint intervls
    $[u_j,v_j] \subseteq [a,b]$ such that
    $\sum{\alpha(u_j)-\alpha(v_j)}<\epsilon$.

    Now suppose that we construct these intervals in such a way that every point
    of $E \cap [a,b]$ lies in $(u_j,v_j)$, for some  $j$. Taking
    $K=\com{[a,b]}{(u_j,v_j)}$,  $K$ is compact, so  $f$ is uniformly continuous
    on $K$. Thus there is a $\delta>0$ such that  $|f(s)-f(t)|<\epsilon$
    whenever  $|s-t|<\delta$ for  $s,t \in K$.

    Now construct the partition  $P$ of $[a,b]$ such that $u_j,v_j \in P$, but
    $(u_j,v_j) \not\subseteq P$ for some  $j$. If  $x_i \neq u_j$, then
    $\Delta{x_i}<\delta$. Notice that  $M_i-m_i \leq 2M$ for all  $i$ and that
    $M_i-m_i \leq \epsilon$. Thus for  $\epsilon$ small enough, we have
    $U(f,P,\alpha)-L(f,P,\alpha) \leq (\alpha(b)-\alpha(a))\epsilon+2M\epsilon$,
    thus $f$ is integrable.
\end{proof}

\begin{theorem}\label{7.1.10}
    Suppose that $f$ is integrable with respect to  $\alpha$ on  an interval
    $[a,b]$, and that  $m \leq f \leq M$, and let  $\phi$ be continuous on
    $[m,M]$, and let  $h=\phi \circ f$ be defined on  $[a,b]$. Then  $h$ is
    integrable with respect to  $\alpha$ on  $[a,b]$.
\end{theorem}
\begin{proof}
    Let $\epsilon>0$. We have that  $\phi$ is uniformly continuous on $[m,M]$,
    so there is a $\epsilon>\delta>0$ for which $|\phi(s)-\phi(t)|<\epsilon$
    whenever  $|s-t|<\delta$, for  $s,t \in [m,M]]$.

    Now since $f$ is integrable, there is a partition  $P$ of  $[a,b]$ such that
    $U(f,P, \alpha)-L(f,P,\alpha)<\delta^2$. Let  $M_i=\sup{f}$, $m_i=\inf{f}$ and 
    $M_i'=\sup{h}$, $m_i'=\inf{h}$ for all  $x_{i-1} \leq x \leq x_i$. Now
    divide  $\{1, \dots, n\}$ into two sets  $A$ and  $B$ such that  $i \in A$
    if  $M_i-m_i<\delta$ and  $i \in B$ if  $M_i-m_i>\delta$  (then $A$ and  $B$
    are disjoint). Then for $i \in A$, we get  $M_i'-m_i' \leq \epsilon$, and
for  $i \in B$, we get  $M_i'-m_i' \leq 2K$ with  $K=\sup{|\phi|}$ for  $m \leq
t \leq M$.
    \begin{equation*}
        \delta\sum_{i\ in B}{\Delta{\alpha_i}} \leq \sum_{i \in B}{(M_i-m_i)\Delta{\alpha_i}}<\delta^2
    \end{equation*}
    so $\sum{\Delta{\alpha_i}}<\delta$. Then
        \begin{align*}
            U(h,P,\alpha)-L(h,P,\alpha) &= \sum_{i \in A}{(M_i'-m_i')\Delta{\alpha_i}}+\sum_{i \in B}{(M_i'-m_i')\Delta{\alpha_i}} \\ 
                              &\leq \epsilon(\alpha(b)-\alpha(a))+2K\delta \\
                              &<\epsilon(\alpha(b)-\alpha(a)+2K)
        \end{align*}
    Then for $\epsilon$ small enough, we get that  $h$ is integrable.
\end{proof}

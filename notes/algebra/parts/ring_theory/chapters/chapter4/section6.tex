\section{Seperability}
\label{section_8.6}

\begin{definition}
  Let $F$ be a field, and let $f(x) \in F[x]$ have the factorization
  \begin{equation*}
    f(x)=a_n(x-\a_1)^{n_1} \dots (x-\a_k)^{n_k}
  \end{equation*}
  over the corresponding splitting field, and where $n_i \geq 1$ for
  all $1 \leq i \leq k$. We call the root $\a_i$ a \textbf{multiple
  root} if $n_i>1$; otherwise we call $\a_i$ a \textbf{simple} root.
  We call $n_i$ the  \textbf{multiplicity} of $\a_i$.
\end{definition}

\begin{definition}
  We call a polynomial $f(x)$ over a field $F$ \textbf{seperable} if,
  and only if it has no multiple roots. Otherwise, we call $f(x)$
  \textbf{inseperable}.
\end{definition}

\begin{example}\label{example_8.14}
  \begin{enumerate}
    \item[(1)] $x^2-2$ is seperable over $\Q$, observe
      $x^2-2=(x-\sqrt{2})(x+\sqrt{2})$. However, $(x^-2)^n$ is
      inseperable over $\Q$ for any $n \geq 2$, since
      $(x^2-2)^n=(x-\sqrt{2})^n(x+\sqrt{2})^n$, making $\pm{\sqrt{2}}$
      roots of multiplicty $n$.

    \item[(2)] $x^2+t$ over  $\F_2(t)$ is irreducible by the
      Eisenstein-Sch\"onemann criterion. Now, let $\sqrt{t}$ be a root
      of $x^2-t$ over $\F_2(t)$. Then
      \begin{equation*}
        (x+\sqrt{t})^2=x^t+2x\sqrt{t}+t=x^2+t
      \end{equation*}
      which makes $x^2+t$ inseperable over $\F_2(t)$, and hence
      $\sqrt{t}$ is a root of multiplicity $2$.
  \end{enumerate}
\end{example}

\begin{definition}
  Let $F$ be a field, and let $f(x) \in F[x]$ a polynomial expanded
  as:
  \begin{equation*}
    f(x)=a_nx^n+a_{n-1}x^{n-1}+\dots+a_2x^2+a_1x+a_0
  \end{equation*}
  We define the \textbf{derivative} of $f(x)$ to be the polynomial
  $D{f(x)} \in F[x]$:
  \begin{equation*}
    D{f(x)}=na_nx^{n-1}+(n-1)a_{n-2}x^{n-1}+\dots+2a_2x+a_1
  \end{equation*}
\end{definition}

\begin{proposition}\label{proposition_8.6.1}
  Let $F$ be a field, and let $f(x),g(x) \in F[x]$. Then the following
  are true:
  \begin{enumerate}
    \item[(1)] $D{(af+bg(x))}=aD{f(x)}+bD{g(x)}$ for $a,b \in F$.

    \item[(2)] $D{(fg(x))}=g(x)D{f(x)}+f(x)D{g(x)}$.

    \item[(3)] If $D{f(x)}=0$, then $f(x)$ is constant.
  \end{enumerate}
\end{proposition}
\begin{proof}
  Both (1) and (2) follow directly from the definition of the
  derivative. Now, suppose that $f(x)=a_nx^n+\dots+a_2x^2+a_1x+a_0$,
  and suppose that $D{f(x)}=0$. Then
  \begin{equation*}
    na_nx^{n-1}+\dots+2a_2x+a_1=0
  \end{equation*}
  which implies that $a_1=a_2=\dots=a_n=0$, hence $f(x)=a_0$ which
  makes $f(x)$ constant.
\end{proof}

\begin{proposition}\label{proposition_8.6.2}
  A polynomial $f(x)$ over a field $F$ has a multiple root $\a$ if,
  and only if $\a$ is also a root of $D{f(x)}$.
\end{proposition}
\begin{proof}
  Suppose first that $\a$ is a multiple root of $f(x)$, with
  multiplicity $n \geq 2$. Then
  \begin{equation*}
    f(x)=(x-\a)^ng(x) \text{ for some } g(x) \in F[x]
  \end{equation*}
  then
  \begin{align*}
    D{f(x)} &= g(x)D{((x-\a)^n)}+(x-\a)^nD{g(x)} \\
      &= n(x-\a)^{n-1}g(x)+(x-\a)^nD{g(x)} \\
  \end{align*}
  which shows that $D{f(\a)}=0$.

  Conversely suppose that $\a$ is a root of $f(x)$ and of $D{f(x)}$.
  Then
  \begin{equation*}
    f(x)=(x-\a)g(x) \text{ where } g(x) \in F[x]
  \end{equation*}
  and
  \begin{equation*}
    D{f(x)}=g(x)+(x-\a)D{g(x)}
  \end{equation*}
  Now, if $D{f(\a)}=0$, then $g(\a)=0$ so $g(x)=(x-\a)h(x)$ for some
  $h(x) \in F[x]$. Then we have
  \begin{equation*}
    f(x)=(x-\a)^2h(x)
  \end{equation*}
  and $f(x)$ has $\a$ as a root with multiplicity at least $2$.
\end{proof}
\begin{corollary}
  $\a$ is a multiple root if, and only if the minimal polynomial of
  $\a$, $m_\a(x)$ divides $f(x)$ $D{f(x)}$. In particular, $f(x)$ is
  seperable if, and only if $(f,D{f})=1$.
\end{corollary}
\begin{proof}
  If $\a$ is a root of $f(x)$ and $D{f(x)}$, then by proposition
  \ref{proposition_8.2.2}, $m_\a(x) \divides f(x)$ and $m_\a(x)
  \divides D{f(x)}$. In particular, by definition of the minimal
  polynomial, $(f,D{f})(x)=m_\a(x)$. So if $f(x)$ is seperable, then
  $m_\a(x) \nmid D{f(x)}$, so $(f,D{f})=1$. Conversely if
  $(f,D{f})=1$ then  no common factors exist, so $\a$ cannot be a
  multiple root.
\end{proof}
\begin{corollary}
  Let $F$ be a field of characteristic $0$. If $p(x) \in
  F[x]$ is irreducible, then $p(x)$ is seperable. Moreover, any
  polynomial over $F$ is seperable if, and only if it is the product
  of distinct irreducible polynomials.
\end{corollary}
\begin{proof}
  Let $p(x)$ be irreducible and have $\deg{p}=n$. Then
  $\deg{D{p}}=n-1$. Now, up to constants, the only factors of $p(x)$
  are $1$ and $p(x)$ itself, so $(p,D{f})=1$, which makes $p(x)$
  seperable. The rest follows from the seperability of irreducible
  polynomials.
\end{proof}
\begin{corollary}
  If $F$ is a field of characteristic $p$, and $q(x) \in F[x]$ is
  irreducible, then $q(x)$ is irreducible if, and only if $D{q(x)}
  \neq 0$.
\end{corollary}

\begin{proposition}[The Freshman's Dream]\label{proposition_8.6.3}
  Let $F$ be a field of characteristic $p$. Then for any $a,b \in F$
  \begin{equation*}
    (a+b)^p=a^p+b^p
  \end{equation*}
\end{proposition}
\begin{proof}
  By the binomial theorem:
  \begin{equation*}
    (a+b)^p=a^p+\sum_{i=1}^{p-1}{{p \choose i}a^{p-i}b^i}+b^p
  \end{equation*}
  Now, since $p$ is prime, for  $1 \leq i \leq p-1$, $p \divides
  {p \choose i}$, hence the sum
  \begin{equation*}
    \sum_{i=1}^{p-1}{{p \choose i}a^{p-i}b^i}=0
  \end{equation*}
  and we are done.
\end{proof}
\begin{corollary}
  The map $F \xrightarrow{} F$ defined by $a \xrightarrow{} a^p$ is a
  1--1 homomorphism.
\end{corollary}
\begin{corollary}
  If $F$ is a finite field of $\char{F}=p$, then every element is a
  $p$-th power in $F$.
\end{corollary}
\begin{corollary}
  Since the map $F \xrightarrow{} F$ defined by $a \xrightarrow{} a^p$
  is 1--1, and $F$ is finite, this map must also be onto.
\end{corollary}

\begin{definition}
  Let $F$ be a field of characteristic $p$. We call the map $F
  \xrightarrow{} F$ defined by $a \xrightarrow{} a^p$ the
  \textbf{Frobenius endomorphism}. If $F$ is a finite field, then we
  call this map the \textbf{Frobenius automorphism}.
\end{definition}

\begin{proposition}\label{proposition_8.6.4}
  Let $F$ be a finite field of characteristic $p$. If $q(x) \in F[x]$
  is irreducible, then it is seperable. Moreover, every polynomial
  over $F$ is seperable if, and only if it is the product of distinct
  irreducible polynomials.
\end{proposition}
\begin{proof}
  Let $q(x) \in F[x]$ be irreducible, and suppose $q(x)$ is
  inseperable. Then by the Frobenius automorphism
  \begin{equation*}
    q(x)=g(x^p) \text{ for some } g(x) \in F[x]
  \end{equation*}
  then
  \begin{align*}
    q(x) &= g(x^p) \\
    &= a_m(x^p)^m+\dots+a_1x^p+a_0 \\
    &= b_m^p(x^p)^m+\dots+b_1^px^p+b_1^p \\
    &= (b_mx^m+\dots+b_1x+b_1)^p \\
  \end{align*}
  which contradicts the irreducibility of $q(x)$. The rest follows
  from the seperability of irreducible polynomials.
\end{proof}

\begin{definition}
  We call a field $F$ \textbf{perfect} if $\char{F}=0$, or if
  $\char{F}=p$ and the Frobenius endomorphism on $F$ is onto.
\end{definition}

\begin{theorem}\label{theorem_8.6.5}
  Every polynomial over a perfect field is seperable.
\end{theorem}

\begin{example}\label{example_8.15}
  Let $n \geq 1$, and consider the splitting field of $x^{p^n}-x$ over
  the finite field $\F_p$ of  $\char{\F_p}=p$. Since $\F_p$ is
  perfect by theorem \ref{theorem_8.6.5}, $x^{p^n}-x$ is seperable
  over $\F_p$, and hence has exactly $p^n$ roots. Now, let $\a$ and
  $\b$ be roots of $x^{p^n}-x$ over $\F_p$. Then  $\a^{p^n}=\a$ and
  $\b^{p^n}=\b$. Then we get $(\a+\b)^{p^n}=\a^{p^n}+\b^{p^n}$ (by the
  freshman's dream), $(\a\b)^{p^n}=\a^{p^n}\b^{p^n}$, and
  $(\inv{\a})^{p^n}=\inv{\a}$ (provided $\a \neq 0$). Letting $\F_q$
  the set of all roots of $x^{p^n}-x$, we have shown that $\F_q$ is a
  field. Indeed, we can also observe that:
  \begin{equation*}
    \F_q \simeq \faktor{\F_p[x]}{(x^{p^n}-x)}
  \end{equation*}
  so that $|\F_q|=p^n$. This makes $[\F_q:\F_p]=n$.

  Now, let $\F$ be any field of degree $n$ over $\F_p$ as a prime
  subfield. Then the unit group  $\Uc(\F)=\com{\F}{\{0\}}$ is cyclic
  of order $p^n-1$. So if $\a \neq 0$ in $\F$, $a^{p^n-1}=1$, so that
  $\a^{p^n}=\a$. This makes $\a$ a root of $x^{p^n}-x$ over $\F_p$.
  This makes $\F$ a subfield of the splitting field of $x^{p^n}-x$.
  However, since $[\F:\F_p]=n$, $\F$ must also be a splitting field of
   $x^{p^n}-x$ over $\F_p$. By uniqueness of splitting fields up to
   isomorphism, this makes $\F \simeq \F_q$.
\end{example}

\begin{proposition}\label{proposition_8.6.6}
  Let $F$ be a field of characteristic $p$, and let $q(x) \in F[x]$ an
  irreducible polynomial. Then there exists a unique integer $k \geq
  0$, and a unique irreducible seperable polynomial $q_k(x) \in F[x]$
  such that
  \begin{equation*}
    q(x)=q_k(x^{p^k})
  \end{equation*}
\end{proposition}
\begin{proof}
  If $q(x)$ is seperable, then take $k=0$ and we are done. Now, if
  $q(x)$ is inseperable, then $D{q(x)}=0$, so $q(x)=q_1(x^p)$, for
  some $q_1(x) \in F[x]$. Now, if $q_1(x)$ is seperable, we take $k=1$
  and we are done. Otherwise, $q_1(x)$ is inseperable, and we get by
  the above reasoning that $q_1(x)=q_2(x^p)$, so that
  $q(x)=q_2(x^{p^2})$. Therefore, by induction on $k \geq 2$, there
  must be some $q_k(x) \in F[x]$ for which $q(x)=q_k(x^{p^k})$, where
  $D{q_k(x)} \neq 0$. Indeed, we have that $q_k(x)$ is irreducible
  since any factor of $q_k(x^{p^k})$ must also be a factor of $q(x)$.
  Moreover since $D{q_k(x)} \neq 0$, this process terminates, and
  makes $q_k(x)$ seperable.
\end{proof}
\begin{corollary}
  Every finite extension of a perfect field is seperable.
\end{corollary}
\begin{corollary}
  Any finite extension of $\Q$ or $\F_p$ is seperable.
\end{corollary}

\begin{definition}
  Let $q(x)$ be an irreducible polynomial over a field of
  characteristic $p$, and let $k \geq 0$ and $q_{sep}(x)$ the unique
  integer and irreducible seperable polynomial for which
  \begin{equation*}
    q(x)=q_{sep}(x^{p^k})
  \end{equation*}
  We call the degree of $q_{sep}(x)$ the \textbf{seperability degree}
  of $q(x)$, and we call $p^k$ the  \textbf{inseperabiltiy degree} of
  $q(x)$ and we write $\deg_{sep}{q}=\deg{q_{sep}}$ and
  $\deg_{insep}=p^k$.
\end{definition}

\begin{proposition}\label{proposition_8.6.7}
  Let $q(x)$ be an irreducible polynomial over a field of
  characteristic $p$. Then
  \begin{equation*}
    \deg{q}=(\deg_{sep}{q})(\deg_{insep}{q})
  \end{equation*}
\end{proposition}

\begin{definition}
  Let $F$ be a field, and $K$ an extension of $F$. We call  $K$
  \textbf{seperable} over $F$ if every element of  $K$ is a root of a
  seperable polynomial over  $F$.
\end{definition}

\begin{example}\label{example_8.16}
  \begin{enumerate}
    \item[(1)] By the Eisenstein-Sch\"onemann criterion, the
      polynomial $q(x)=x^p+t$ is irreducible over $\F_p(t)$. Moreover,
      $D{q(x)}=0$, hence $q(x)$ is inseperable over $\F_p(t)$. Then by
      above, $q_{sep}(x)=x-t$, and $\deg_{sep}{q}=1$. Now, $x^p-t$ has
      the single root  $\sqrt[p]{t}$ of multiplicity $p$; i.e.
      $x^p-t=(x-\sqrt[p]{t})^p$.

    \item[(2)] $x^{p^m}-t$ is irreducible over $\F_p(t)$ with
      inseperability degree $p^m$.

    \item[(3)] $(x^{p^2}-t)(x^p-t)$ is inseperable over $\F_p(t)$,
      since it is the product of inseperable polynomials. However,
      observe that there is no polynomial $f(x) \in \F_p(t)[x]$ for
      which $(x^{p^2}-t)(x^p-t)=f(x^{p^k})$ for some $k \geq 0$.
  \end{enumerate}
\end{example}

We finish this section by noting some more properties of the
derivative of polynomials.

\begin{proposition}\label{proposition_8.6.8}
  Let $F$ be a field. Then for $f(x), g(x) \in F[x]$ the following
  hold:
  \begin{enumerate}
    \item[(1)] For any $m \in \Z^+$ $D{f(x)^n}=nf(x)^{n-1}D{f(x)}$

    \item[(2)] $D{f(g(x))}=(D{f})(g(x))D{g(x)}$
  \end{enumerate}
\end{proposition}
\begin{proof}
  Observe $f(x)^n=f(x)f(x)^{n-1}$, so
  $D{f(x)^n}=f(x)D{f(x)^{n-1}}+f(x)^{n-1}D{f(x)}$. By repeated use of
  the product rule, we get the result.

  Now, let $f(x)=a_nx^n+\dots_a_2x^2+a_1x+a_0$. Then
  \begin{equation*}
    f(g(x))=a_ng(x)^n+\dots+a_2g(x)^2+a_1g(x)+a_0
  \end{equation*}
  Then
  \begin{align*}
    D{f(g(x))} &= \sum_{i=0}^{n}{a_iD{g(x)^i}} \\
    &= \sum_{i=0}^n{ia_ig(x)^{i-1}D{g(x)}} \\
    &= (na_ng(x)^{n-1}+\dots+a_2g(x)+a_1)D{g(x)} \\
    &= (D{f})(g(x))D{g(x)} \\
  \end{align*}
\end{proof}

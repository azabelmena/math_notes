\section{Unique Factorization Domains}
\label{section_6.3}

\begin{definition}
  Let $R$ be an integral domain. An element $p \in R$ is called \textbf{prime}
  if the ideal $(p)$ is a prime ideal. That is $p$ is not a unit and whenever
  $p|ab$, then either  $p|a$ or $p|b$. We call two elements $a,b \in R$
  \textbf{associate} if $a=ub$ for some unit $u \in R$.
\end{definition}


\begin{definition}
  Let $R$ be an integral domain. A nonzero element  $r \in R$ that is not an
  associate is called \textbf{irreducible} if whenever $r=ab$, then either $a$
  or $b$ are units in $R$; otherwise, we call $r$ \textbf{reducible}.
\end{definition}

\begin{proposition}\label{proposition_6.3.1}
  In an integral domain, a prime element is always irreducible.
\end{proposition}
\begin{proof}
  Let $(p)$ be a nonzero prime ideal with $p=ab$, for some  $a,b \in R$. Then
  $ab \in (p)$, so that either $a \in (p)$, or $b \in (p)$. Suppose that $a
  \in (p)$. Then $a=pr$ for some  $r \in R$, so that  $p=(pr)b=p(rb)$, so
  that $rb=1$. This makes $b$ a unit. Similarly, we see that $a$ is a unit if
  $b \in (p)$. In either case, $p$ is irreducible.
\end{proof}

\begin{example}\label{example_6.6}
  \begin{enumerate}
    \item[(1)] In the ring $\Z$ of integers, those elements which are
      irreducible are precisely those which are prime, since the ideals
      $2\Z, 3\Z, \dots, p\Z, \dots$ for  $p$ a prime number are also the
      prime ideals of $\Z$

    \item[(2)] Irreducible elements need not be prime. The element $3 \in
      \Z[\sqrt{-5}]$ is irreducible, as was shown in example
      \ref{example_6.2},
      however it is not prime. Notice that
      $3|9=(2+\sqrt{-5})(2-\sqrt{-5})$, but $3 \nmid (2+\sqrt{-5})$ and
      $3 \nmid (2-\sqrt{-5})$.
  \end{enumerate}
\end{example}

\begin{proposition}\label{proposition_6.3.2}
  In a principle ideal domain, a nonzero element is prime if, and only if it
  is irreducible.
\end{proposition}
\begin{proof}
  Let $R$ be a PID, and suppose that $p$ is irreducible. Let $(m)$ be the
  principle ideal containing $(p)$, then $p=rm$, and by irreducibility, either
  $r$ or $m$ are units, in either case, we get that either $(p)=(m)$ or
  $(m)=(1)$. This makes $(p)$ a maximal ideal, and hence a prime
  ideal. Now, since prime elements in integral domains are
  irreducible, and PIDs are integral domains, the converse follows
  from proposition \ref{proposition_6.3.1}.
\end{proof}

\begin{example}\label{example_6.7}
  \begin{enumerate}
    \item[(1)] Since $3$ is not prime in  $\Z[\sqrt{-5}]$, then $(3)$ is not
      a prime ideal in this ring. Therefore $\Z[\sqrt{-5}]$ cannot be a
      PID.

    \item[(2)] Notice that since $\Z$ is a PID, then the fact that
      irreducible and prime elements coincide is guaranteed by proposition
      \ref{proposition_6.3.2}.
  \end{enumerate}
\end{example}

\begin{definition}
  We call an integral domain $R$ a  \textbf{unique factorization domain (UFD)}
  if for every nonzero element $r \in R$ which is not a unit, the following
  are true.
  \begin{enumerate}
    \item[(1)] $r$ can be written as the product of, not necessarily distinct,
      irreducible elements. We call this product the
      \textbf{factorization} of $r$.

    \item[(2)] The factorization of $r$ is unique up to associates.
  \end{enumerate}
\end{definition}

\begin{example}\label{example_6.8}
  \begin{enumerate}
    \item[(1)] All fields are unique factorization domains.

    \item[(2)] Polynomial rings are unique factorization domains whenever
      the ground ring is a unique factorization domain.

    \item[(3)] The subring $\Z[2i]$ of $\Z[i]$ is an integral domain, but it
      is not a UFD. Notice that both $2$ and  $2i$ are irreducible in
      $\Z[2i]$, but that $4=2 \cdot 2=(2i) \cdot (-2i)$.

    \item[(4)] $\Z[\sqrt{-5}]$ is another example of an integral domain that
      is not a UFD.
  \end{enumerate}
\end{example}

\begin{proposition}\label{proposition_6.3.3}
  In a unique factorization domain $R$, a nonzero element is prime if, and
  only if it is irreducible.
\end{proposition}
\begin{proof}
  Since prime elements are irreducible, it remains to show that irreducible
  elements are prime. Let $p$ be irreducible and suppose that  $p|ab$, for
  $a,b \in R$. Then  $ab=pc$ for some  $c \in R$. Writing  $ab$ as a product
  of irreducibles, since  $R$ is a UFD,  $p$ must be associate to one of the
  irreducibles in the factorization of $a$, or to one in the factorization of
  $b$. In either case, we get that $p|a$ or $p|b$, and hence  $p$ is prime.
\end{proof}

\begin{proposition}\label{proposition_6.3.4}
  Let $a,b \in R$ nonzero elements of a unique factorization domain $R$. If
  $a=up_1^{e_1} \dots p_n^{e_n}$ and $b=vp_1^{f_1} \dots p_n^{f_n}$, where
  $u,v \in R$ are units, then the element
  \begin{equation*}
    d=p_1^{\min\{e_1,f_1\}} \dots p_n^{\min\{e_n,f_n\}}
  \end{equation*}
  os the greatest common divisor of $a$ and  $b$.
\end{proposition}
\begin{proof}
  Notice that by definition of $d$, that  $d|a$ and  $d|b$. Now, let  $c$ be a
  common divisor of  $a$ and  $b$ with the unique prime factorization
  $c=q_1^{g_1} \dots q_m^{g_m}$. Since $q_i|c$ for each  $1 \leq i \leq m$,
  then  $q_i|p_j$ for each prime factor in the factorizations of  $a$ and
  $b$. Since both  $q_i$ and  $p_j$ are irreducible, they are associates. That
  implies that the primes of  $c$ are the primes of  $a$ and  $b$. Moreover
  notice that since each $g_i \leq e_i,f_i$, that  $c|d$, and so  $d=(a,b)$.
\end{proof}

\begin{theorem}\label{proposition_6.3.5}
  Every principle ideal domain is a unique factorization domain.
\end{theorem}
\begin{proof}
  Let $R$ be a PID, and  $r \in R$ a nonzero element which is not a unit. If
  $r$ is irreducible, we are done. Otherwise, we have  $r=r_1r_2$ fr some
  $r_1,r_2 \in R$. Now, if both $r_1$ and $r_2$ are irreducible, we are done.
  Suppose then, without loss of generality, thart $r_1$ is reducible. Then
  $r_1=r_{11}r_{12}$, and if both $r_{11}$ and $r_{12}$ are irreducible, we
  are done. Suppose then that $r_{11}$ is reducible; continuing this process,
  we arrive at an infinite ascending chain of ideals
  \begin{equation*}
    (r) \subseteq (r_1) \subseteq (r_{11}) \subseteq \dots \subseteq (1)
  \end{equation*}
  and since $R$ is a PID, by proposition \ref{proposition_6.2.4} this chain stabalizes. Thus
  $r$ can be factored into irreducible elements; since this process terminates.

  Now, by induction on $n$, for  $n=0$, we notice that  $r$ is a unit, and we
  are done. Suppose, then for  $n \geq 1$, that  $r=p_1 \dots p_n=q_1 \dots
  q_m$ for some $m \geq n$, and where each  $p_i$ and  $q_j$ are  (not
  necessarily distinct) irreducibles for all $1 \leq i \leq n$ and $1 \leq j
  \leq m$. Notice that  $p_1|q_1 \dots q_m$, and so $p_1|q_j$ for some $j$.
  This makes  $p_1$ and $q_j$ associates; i.e.  $q_j=p_1u$, with $u \in R$ a
  unit. Cancelling the  $p_1$ from both sides of the equation, we get $p_2
  \dots p_n=q_1 \dots q_{j-1}q_{j+1} \dots q_m$. Repeating this process, we
  get a 1--1 correspondence between associates, and hence the factorization of
  $r$ is unique up to associates. Therefore  $R$ is a UFD.
\end{proof}
\begin{corollary}
  Every Euclidean domain is a unique factorization domain.
\end{corollary}
\begin{proof}
  Euclidean domains are PIDs by proposition \ref{proposition_6.1.1}.
\end{proof}
\begin{corollary}[The Fundamental Theorem of Arithmetic]
  $\Z$ is a unique factorization domain.
\end{corollary}
\begin{proof}
  $\Z$ is a Euclidean domain.
\end{proof}
\begin{corollary}
  There exists a multiplicative Dedekind-Hasse norm on $R$.
\end{corollary}
\begin{proof}
  If $R$ is a PID, then the theorem tells us it is a UFD. Define the norm $N:R
  \xrightarrow{} \N$ by taking $0 \xrightarrow{} 0$, $u \xrightarrow{} 1$ if
  $u$ is a unit, and  $a \xrightarrow{} 2^n$ where $a=p_1 \dots p_n$, where
  each $p_i$ is irreducible. Notice that for every  $a,b \in R$,
  $N(ab)=N(a)N(b)$. Now, suppose further that $a,b \neq 0$ and consider the
  ideal  $(a,b)=(r)$, for some $r \in R$. UIf  $a \notin (b)$, nether is $r$,
  and hence  $b \nmid r$. Now, since  $b=xr$,  $x \in R$, then  $x$ cannot be
  a unit in  $R$, so that  $N(b)=N(xr)=N(x)N(r)>N(r)$. This completes the
  proof.
\end{proof}
